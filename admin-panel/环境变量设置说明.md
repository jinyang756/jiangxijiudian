# 江西酒店管理面板环境变量设置说明

## 问题说明

由于 Supabase 静态网站托管不支持环境变量，我们无法直接在托管环境中设置环境变量。为了解决这个问题，我们实现了一个本地存储解决方案，允许您在浏览器中设置和保存环境变量。

## 使用方法

### 1. 设置环境变量

1. 打开 `set-env.html` 文件
2. 在表单中输入您的 Supabase URL 和 Anon Key
3. 点击"保存环境变量"按钮

默认值已经填入，如果您使用的是标准配置，可以直接保存。

### 2. 测试连接（可选但推荐）

在设置环境变量后，建议先测试连接是否正常：

1. 打开 `connection-test.html` 文件
2. 确认 Supabase URL 和 Anon Key 正确
3. 点击"测试连接"按钮
4. 查看测试结果，确保所有测试都通过

### 3. 部署管理面板（如果尚未部署）

如果管理面板尚未部署到 Supabase Storage，请参考 `MANUAL_DEPLOYMENT.md` 文件中的说明进行部署。

### 4. 访问管理面板

连接测试通过后，您可以访问管理面板：

1. 通过以下 URL 访问管理面板：
   ```
   YOUR_SUPABASE_URL/storage/v1/object/public/admin-panel/index.html
   ```
2. 管理面板应该能够正确连接到您的 Supabase 数据库

## 环境变量详情

- **Supabase URL**: `YOUR_SUPABASE_URL`
- **Supabase Anon Key**: `YOUR_SUPABASE_ANON_KEY`

## 技术实现

环境变量通过以下方式实现：

1. 在 `set-env.html` 中，用户输入的环境变量被保存到浏览器的 localStorage
2. 在 `index.html` 中，我们在页面加载时从 localStorage 读取环境变量，并将其设置到 `window.env` 对象
3. 在 `database.js` 中，我们修改了 `getEnvVariable` 方法，使其能够从 `window.env` 或 localStorage 读取环境变量

## 安全注意事项

1. Anon Key 存储在浏览器的 localStorage 中，任何能够访问该浏览器的用户都可以看到它
2. 在生产环境中，建议使用更安全的身份验证方法
3. 定期更换 Anon Key 以提高安全性

## 故障排除

如果管理面板无法显示数据，请检查：

1. 环境变量是否正确设置
2. Supabase 项目是否正常运行
3. 网络连接是否正常
4. 浏览器控制台是否有错误信息